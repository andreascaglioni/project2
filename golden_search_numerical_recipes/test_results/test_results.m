clc;
% close all;
clear;

%% golden search results for quadratic

% % % for real part res = 100 but in range a \in -0.7, 0.7
% eeExt = [-0.751515 -0.751386 -0.751427 -0.751378 -0.751432 -0.75137 -0.498847 -0.751317 -0.751342 -0.751071 -0.751267 -0.751316 -0.751325 -0.725682 -0.621289 -0.575891 -0.546702 -0.526218 -0.512738 -0.505008 -0.502478 -0.505005 -0.512753 -0.526217 -0.546596 -0.576166 -0.62127 -0.725714 -0.75135 -0.751298 -0.751319 -0.751708 -0.751351 -0.745088 -0.75135 -0.751438 -0.751394 -0.751425 -0.751527 -0.751348 ];
% eeExt = -eeExt;
% % for modulus, res =100, but in range a \in -1., 1.
% eeExtMod = [1.0013 0.976675 0.952681 0.929413 0.90695 0.885351 0.498847 0.844879 0.826183 0.808353 0.79215 0.777048 0.763268 0.725682 0.621289 0.575891 0.546702 0.526218 0.512738 0.505008 0.502478 0.505005 0.512753 0.526217 0.546596 0.576166 0.62127 0.725714 0.763288 0.777045 0.79219 0.808863 0.826202 0.843709 0.864636 0.8854 0.907028 0.929491 0.952812 0.976578];
% aaExt = -1.:0.05:0.95;

%% import data
id_unpertrubed = fopen('../test_bistable.out');
A = fscanf(id_unpertrubed, '%f %f %f',[3 inf]); A = A';
aa = A(:,1);
ss = A(:,2:3);
mod = (ss(:,1).^2+ss(:,2).^2).^0.5;
%% plotting 
figure;
plot(aa, -ss(:,1), '.', 'markersize', 15);
hold on;
plot(aa, mod, '.', 'markersize', 15);

legend 'real part' 'modulus'
xlabel 'perturbation'
ylabel 'spectral gap'
grid on;