%% plot convergence to stationary state study of unsteady FP equation
clc;
close all;
clear;
%% plotting


err = [4301.163825803393, 2944.707035109977, 2083.410603978234, 1509.498550758457, 1114.103413961183, 834.7927553653049, 633.5405547608001, 486.1551954546476, 376.7259463021049, 294.5082641289579, 232.0876978905138, 184.2541506962135, 147.2893210567528, 118.5035908621717, 95.92823739138738, 78.10691784786185, 63.95203569652538, 52.64434152842713, 43.56183699926098, 36.22884017049314, 30.27910972850036, 25.42889157526276, 21.45704519452827, 18.19027202138182, 15.49205418291307, 13.25431428923278, 11.39108629080174, 9.833683428212861, 8.52698818349236, 7.426588435107346, 6.496555601387612, 5.707712564362188, 5.036277226045776, 4.462795592365558, 3.971299075096752, 3.54863621615449, 3.183940679095605, 2.868206134530347, 2.593945325880016, 2.354915677417113, 2.145897693005383, 1.962515383332435, 1.80109026858626, 1.65852229435582, 1.532192392560542, 1.41988250811348, 1.319709765311325, 1.230072118619492, 1.149603361174249, 1.077135782201768, 1.011669095796528, 0.9523445268322789, 0.8984231497585468, 0.8492677440049963, 0.8043275645354234, 0.7631255346809095, 0.7252474561558451, 0.6903329023633747, 0.6580675190645857, 0.6281765038362624, 0.6004190745473285, 0.5745837689807989, 0.5504844440200515, 0.5279568645423764, 0.5068557901552012, 0.4870524828424205, 0.46843257100011, 0.4508942156786866, 0.4343465334689474, 0.4187082376680883, 0.4039064653814717, 0.3898757632557301, 0.3765572087623141, 0.3638976474950442, 0.3518490299232216, 0.3403678335453775, 0.3294145584983584, 0.3189532864534119, 0.3089512941317585, 0.2993787140397486, 0.2902082360973203, 0.2814148447415595, 0.2729755868593094, 0.2648693665572463, 0.2570767633355617, 0.2495798707061462, 0.2423621527010998, 0.235408316063652, 0.2287041962095432, 0.2222366553006311, 0.215993490990431, 0.2099633545880265, 0.2041356775481966, 0.1985006053342895, 0.193048937820278, 0.1877720755019884, 0.182661970877282, 0.1777110844328787, 0.172912344742944, 0.1682591122434555, 0.1637451462976604, 0.1593645752123855, 0.1551118689042874, 0.1509818139490842, 0.1469694907768498, 0.1430702528027261, 0.1392797073054112, 0.1355936978861983, 0.13200828835925, 0.1285197479394211, 0.1251245376082268, 0.1218192975505724, 0.1186008355660393, 0.1154661163683022, 0.1124122516944497, 0.1094364911543786, 0.1065362137565868, 0.1037089200532126, 0.1009522248525665, 0.09826385045208294, 0.0956416203492861, 0.0930834533920406, 0.09058735833294021, 0.08815142875599902, 0.08577383834639433, 0.0834528364767918, 0.08118674408598252, 0.07897394982770002, 0.0768129064693349, 0.07470212752201857, 0.07264018408502526, 0.07062570188897317, 0.06865735852337165, 0.06673388083549121, 0.06485404248832721, 0.06301666166655435, 0.06122059892021578, 0.05946475513658696, 0.05774806963159714, 0.05606951835255951, 0.0544281121849252, 0.05282289535597479, 0.05125294392918819, 0.04971736438329425, 0.0482152922705064, 0.04674589094888259, 0.04530835038406209, 0.04390188601595645, 0.0425257376863681, 0.04117916862368836, 0.0398614644811393, 0.03857193242533286, 0.03730990027198732, 0.03607471566602945, 0.03486574530333539, 0.03368237419171576, 0.03252400494873721, 0.03139005713425933, 0.03027996661565936, 0.02919318496383408, 0.02812917887820376, 0.02708742963908963, 0.02606743258588637, 0.02506869661957789, 0.02409074372823436, 0.02313310853424226, 0.02219533786202517, 0.02127699032515515, 0.0203776359318047, 0.01949685570754325, 0.01863424133455056, 0.0177893948063584, 0.01696192809734652, 0.01615146284614098, 0.01535763005228048, 0.01458006978539687, 0.01381843090630431, 0.01307237079937218, 0.01234155511563451, 0.0116256575260723, 0.01092435948457377, 0.01023735000010915, 0.009564325417643099, 0.008904989207377013, 0.008259051761929898, 0.007626230201033801, 0.007006248183461309, 0.0063988357257684, 0.005803729027594455, 0.005220670303170256, 0.004649407618801117, 0.004089694735992693, 0.003541290960024729, 0.003003960993685574, 0.00247747479596623, 0.001961607445481177, 0.001456139008413496, 0.0009608544108098328, 0.0004755433150003937];
dt = 0.01;
nIter = length(err);
tt = dt:dt:(nIter-1)*dt;
lambda = -log(err(2:end)/err(1))./tt;

%err = err(firstIndex:lastIndex);     %consider a subvector

%theoretical = @(x) (exp(-0.5*x));
plot(tt, lambda, '*');
hold on;
%plot(tt, -7 + tt.*(-2));
% hold on;
% plot(tt,theoretical(tt), '*');
grid on;
xlim([0, 2]);
%legend('computed', 'theoretical');

%ttCF = tt(2:end);
%errCF = err(2:end);
% loglog(res, err, '*');
% grid on;
% hold on;
% xx = 8:0.5:256;
% yy = xx.^(-2)*10^2;
% loglog (xx,yy,'k-');
% xlabel 'resolution 1/h';
% ylabel 'eigenvalue error';
% legend('error', 'h^{-2}');